{
  "hash": "8256a06bff373938f5d9d1b5ae917b99",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exploratory Data Analysis\"\nauthor: \"Fan jing\"\ndate: \"April 1st , 2025\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# 1.Overview\n\nIn this section will cover the Exploratory Data Analysis (EDA)\n\n# 2.Initial Data Preparation\n\n## 2.1 Install and launch R packages\n\nThe project uses p_loads of pacman package to check if the R packages are installed in the computer.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, ggplot2, ggthemes, plotly,dplyr,purrr,broom,rlang,ggbetweenstats,BiocManager,ggstatsplot)\n```\n:::\n\n\n\n## 2.2 Import Data\n\nThis project will examine a merged dataset from [World Development Indicators (WDI)](https://databank.worldbank.org/reports.aspx?source=2&series=SP.POP.TOTL&country=) from the World Bank, and [Global Burden of diseases result tools](https://vizhub.healthdata.org/gbd-results/) from Institution for Health Metrics Evaluation. Specifically 140 countries from year 2006 to 2021 and organised into UN regions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncdata <- read_csv(\"data/final_merged_data.csv\")\n```\n:::\n\n\n\n## 2.3 Overview of the data\n\nThe dataset including 2,240 observations and 13 variables. Each row provides detailed yearly information for a specific country on water access, sanitation, hygiene indicators, population statistics and related health outcomes such as diarrhea, typhoid fever, and acute hepatitis A. The dataset includes both environmental indicators (e.g., water stress, basic drinking water access) and health outcome metrics, making it suitable for time-series and panel data analysis across different World Bank regions.\n\n### Dataset Structure\n\nUse `str()`to check the structure of the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(cdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nspc_tbl_ [2,240 × 13] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Country                                                                                         : chr [1:2240] \"Arab Republic of Egypt\" \"Arab Republic of Egypt\" \"Arab Republic of Egypt\" \"Arab Republic of Egypt\" ...\n $ year                                                                                            : num [1:2240] 2006 2007 2008 2009 2010 ...\n $ Level of water stress: freshwater withdrawal as a proportion of available freshwater resources  : num [1:2240] 122 125 128 131 134 ...\n $ People practicing open defecation (% of population)                                             : num [1:2240] 1.179 1.079 0.979 0.88 0.78 ...\n $ People using at least basic drinking water services (% of population)                           : num [1:2240] 98.4 98.5 98.5 98.5 98.5 ...\n $ People using at least basic sanitation services (% of population)                               : num [1:2240] 93.1 93.4 93.7 94.1 94.4 ...\n $ Population density (people per sq. km of land area)                                             : num [1:2240] 83.1 84.7 86.3 87.9 89.6 ...\n $ Population, total                                                                               : num [1:2240] 82700403 84276225 85864789 87501636 89196072 ...\n $ Water productivity, total (constant 2015 US$ GDP per cubic meter of total freshwater withdrawal): num [1:2240] 3.4 3.56 3.72 3.8 3.91 ...\n $ Acute hepatitis A                                                                               : num [1:2240] 0.00894 0.00885 0.00873 0.00858 0.00845 ...\n $ Diarrheal diseases                                                                              : num [1:2240] 0.111 0.113 0.116 0.118 0.12 ...\n $ Typhoid fever                                                                                   : num [1:2240] 1.09e-04 1.03e-04 9.74e-05 9.21e-05 8.70e-05 ...\n $ World Bank Regions                                                                              : chr [1:2240] \"Middle East & North Africa\" \"Middle East & North Africa\" \"Middle East & North Africa\" \"Middle East & North Africa\" ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Country = col_character(),\n  ..   year = col_double(),\n  ..   `Level of water stress: freshwater withdrawal as a proportion of available freshwater resources` = col_double(),\n  ..   `People practicing open defecation (% of population)` = col_double(),\n  ..   `People using at least basic drinking water services (% of population)` = col_double(),\n  ..   `People using at least basic sanitation services (% of population)` = col_double(),\n  ..   `Population density (people per sq. km of land area)` = col_double(),\n  ..   `Population, total` = col_double(),\n  ..   `Water productivity, total (constant 2015 US$ GDP per cubic meter of total freshwater withdrawal)` = col_double(),\n  ..   `Acute hepatitis A` = col_double(),\n  ..   `Diarrheal diseases` = col_double(),\n  ..   `Typhoid fever` = col_double(),\n  ..   `World Bank Regions` = col_character()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n\n\n:::\n:::\n\n\n\n### Column Names in `cdata`\n\nThe command `names(cdata)` in R returns a list of all column names in the `cdata` dataframe.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(cdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Country\"                                                                                         \n [2] \"year\"                                                                                            \n [3] \"Level of water stress: freshwater withdrawal as a proportion of available freshwater resources\"  \n [4] \"People practicing open defecation (% of population)\"                                             \n [5] \"People using at least basic drinking water services (% of population)\"                           \n [6] \"People using at least basic sanitation services (% of population)\"                               \n [7] \"Population density (people per sq. km of land area)\"                                             \n [8] \"Population, total\"                                                                               \n [9] \"Water productivity, total (constant 2015 US$ GDP per cubic meter of total freshwater withdrawal)\"\n[10] \"Acute hepatitis A\"                                                                               \n[11] \"Diarrheal diseases\"                                                                              \n[12] \"Typhoid fever\"                                                                                   \n[13] \"World Bank Regions\"                                                                              \n```\n\n\n:::\n:::\n\n\n\n### Renaming Variable\n\nTo simplify and standardize the dataset for analysis, we renamed several lengthy variable names into shorter, more interpretable labels using the `rename()` function.This improves code readability and makes referencing variables in models and visualizations easier.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncdata <- cdata %>%\n  rename(\n    BasicSanitation = `People using at least basic sanitation services (% of population)`,\n    BasicWater = `People using at least basic drinking water services (% of population)`,\n    OpenDefecation = `People practicing open defecation (% of population)`,\n    WaterStress = `Level of water stress: freshwater withdrawal as a proportion of available freshwater resources`,\n    WaterProductivity = `Water productivity, total (constant 2015 US$ GDP per cubic meter of total freshwater withdrawal)`,\n    HepatitisA = `Acute hepatitis A`,\n    Diarrhea = `Diarrheal diseases`,\n    Typhoid = `Typhoid fever`,\n    Region = `World Bank Regions`)\n```\n:::\n\n\n\n### Creating Year group\n\nIn this step, the dataset `cdata` is augmented with a new variable called `year_group` using the `mutate()` and `case_when()` functions from the **dplyr** package. The result is saved as a new dataframe `cdata1`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncdata1 <- cdata %>%\n  mutate(year_group = case_when(\n    year >= 2006 & year <= 2010 ~ \"2006-2010\",\n    year >= 2011 & year <= 2015 ~ \"2011-2015\",\n    year >= 2016 & year <= 2021 ~ \"2016-2021\",\n    TRUE ~ NA_character_\n  ))\n```\n:::\n\n\n\n# 3.Regional Disparities Across WASH and Health Indicators: A Multi-Variable ANOVA Analysis\n\nThis code performs a **batch ANOVA analysis** across multiple WASH and health outcome variables (`variables_to_test`) to examine whether there are **statistically significant regional differences** within each time period (`year_group`).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariables_to_test <- c(\"BasicSanitation\", \"BasicWater\", \"OpenDefecation\", \n                       \"WaterStress\", \"WaterProductivity\", \n                       \"Diarrhea\", \"Typhoid\", \"HepatitisA\")\n\n\nall_aov_results <- map_dfr(variables_to_test, function(var) {\n  cdata1 %>%\n    filter(!is.na(.data[[var]])) %>%\n    group_by(year_group) %>%\n    group_modify(~{\n      model <- aov(reformulate(\"Region\", response = var), data = .x)\n      tidy_result <- tidy(model)\n      tidy_result$variable <- var\n      tidy_result\n    })\n})\n```\n:::\n\n\n\n## 3.1 Violin Plot\n\nThis code block defines two functions: `create_comprehensive_plots()` and `save_plots()`. Together, they automate the generation and export of a large set of **statistically annotated visualizations** comparing multiple WASH and health outcome indicators across time periods and regions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_comprehensive_plots <- function(data) {\n  # Diagnostic checks\n  cat(\"Total number of rows in data:\", nrow(data), \"\\n\")\n  cat(\"Unique regions:\", paste(unique(data$Region), collapse = \", \"), \"\\n\")\n  cat(\"Unique year groups:\", paste(unique(data$year_group), collapse = \", \"), \"\\n\")\n  \n  all_vars <- c(\"BasicSanitation\", \"BasicWater\", \"OpenDefecation\", \n                \"WaterStress\", \"WaterProductivity\", \n                \"HepatitisA\", \"Diarrhea\", \"Typhoid\")\n  \n  missing_vars <- setdiff(all_vars, names(data))\n  if (length(missing_vars) > 0) {\n    stop(\"Missing variables: \", paste(missing_vars, collapse = \", \"))\n  }\n  \n  regions <- unique(data$Region)\n  plot_list <- list()\n  plot_counter <- 1\n  \n  for (var in all_vars) {\n    for (reg in regions) {\n      region_data <- data %>% \n        filter(Region == reg) %>%\n\n        filter(!is.na(year_group) & !is.na(!!sym(var)))\n      \n      if (nrow(region_data) == 0) {\n        warning(paste(\"No data for\", var, \"in\", reg))\n        next\n      }\n      \n      tryCatch({\n        p <- ggbetweenstats(\n          data = region_data,\n          x = year_group,\n          y = !!sym(var),\n          type = \"parametric\",\n          messages = FALSE,\n          mean.ci = TRUE,\n          pairwise.comparisons = TRUE,\n          pairwise.display = \"significant\",\n          title = paste(\"Comparison of\", var, \"in\", reg),\n          xlab = \"Year Group\",\n          ylab = var\n        )\n        \n        plot_list[[plot_counter]] <- p\n        print(p)\n        \n        plot_counter <- plot_counter + 1\n      }, error = function(e) {\n        warning(paste(\"Error plotting\", var, \"in\", reg, \":\", e$message))\n      })\n    }\n  }\n  \n  return(plot_list)\n}\n\n\nplots <- create_comprehensive_plots(cdata1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTotal number of rows in data: 2240 \nUnique regions: Middle East & North Africa, East Asia & Pacific, Latin America & Caribbean, Sub-Saharan Africa, North America, Europe & Central Asia, South Asia \nUnique year groups: 2006-2010, 2011-2015, 2016-2021 \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-11.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-12.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-13.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-14.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-15.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-16.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-17.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-18.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nError in optim(0, Qg, control = list(fnscale = -1), gr = dQg, method = \"BFGS\",  : \n  initial value in 'vmmin' is not finite\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-19.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-20.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-21.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-22.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-23.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-24.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-25.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-26.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-27.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-28.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-29.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-30.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-31.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-32.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-33.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-34.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-35.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-36.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-37.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-38.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-39.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-40.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-41.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-42.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-43.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-44.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-45.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-46.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-47.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-48.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-49.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-50.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-51.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-52.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-53.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-54.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-8-55.png){width=672}\n:::\n:::\n\n\n\n# 4.Box Plot Visualization of Regional Trends by Year\n\nTo examine regional disparities in water, sanitation and hygiene access and health outcomes over time, we generated a series of box plots for key indicators, including basic sanitation, access to drinking water, open defecation, water stress, water productivity, and disease prevalence (Hepatitis A, diarrhea, and typhoid). For each year in the dataset, the data was subset by year, and box plots were created to visualize the distribution of each indicator across different regions. This method provides a clear view of the central tendency, spread, and potential outliers within regions, enabling comparative analysis across both space and time. By using box plots, we were able to identify variations in access and health burdens, detect extreme cases, and observe trends in regional equity on a year-by-year basis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_regional_yearly_boxplots <- function(data) {\n  variables <- c(\"BasicSanitation\", \"BasicWater\", \"OpenDefecation\", \n                 \"WaterStress\", \"WaterProductivity\", \n                 \"HepatitisA\", \"Diarrhea\", \"Typhoid\")\n  \n  years <- sort(unique(data$year))\n  \n  for (var in variables) {\n    for (current_year in years) {\n      year_data <- data %>% filter(year == current_year)\n            p <- ggplot(year_data, aes(x = Region, y = !!sym(var))) +\n        geom_boxplot(fill = \"skyblue\", color = \"black\", \n                     outlier.shape = 16, outlier.size = 1.5) +\n        labs(\n          title = paste(var, \"By Region in\", current_year),\n          x = \"Region\",\n          y = \"Percentage\"\n        ) +\n        theme_minimal() +\n        theme(\n          axis.text.x = element_text(angle = 45, hjust = 1),\n          plot.title = element_text(size = 14, face = \"bold\")\n        )\n      \n      print(p)\n    }\n  }\n}\n\n\ncreate_regional_yearly_boxplots(cdata)\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-11.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-12.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-13.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-14.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-15.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-16.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-17.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-18.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-19.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-20.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-21.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-22.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-23.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-24.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-25.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-26.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-27.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-28.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-29.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-30.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-31.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-32.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-33.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-34.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-35.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-36.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-37.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-38.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-39.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-40.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-41.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-42.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-43.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-44.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-45.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-46.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-47.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-48.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-49.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-50.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-51.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-52.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-53.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-54.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-55.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-56.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-57.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-58.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-59.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-60.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-61.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-62.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-63.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-64.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-65.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-66.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-67.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-68.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-69.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-70.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-71.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-72.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-73.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-74.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-75.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-76.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-77.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-78.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-79.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-80.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-81.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-82.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-83.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-84.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-85.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-86.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-87.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-88.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-89.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-90.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-91.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-92.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-93.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-94.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-95.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-96.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-97.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-98.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-99.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-100.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-101.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-102.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-103.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-104.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-105.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-106.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-107.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-108.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-109.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-110.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-111.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-112.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-113.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-114.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-115.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-116.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-117.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-118.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-119.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-120.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-121.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-122.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-123.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-124.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-125.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-126.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-127.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-128.png){width=672}\n:::\n:::\n\n\n\n```         \n```\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(cdata$Country)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"Arab Republic of Egypt\"                              \n  [2] \"Australia\"                                           \n  [3] \"Belize\"                                              \n  [4] \"Brunei Darussalam\"                                   \n  [5] \"Burkina Faso\"                                        \n  [6] \"Canada\"                                              \n  [7] \"Central African Republic\"                            \n  [8] \"Czech Republic\"                                      \n  [9] \"Democratic Republic of Sao Tome and Principe\"        \n [10] \"Democratic Republic of Timor-Leste\"                  \n [11] \"Democratic Socialist Republic of Sri Lanka\"          \n [12] \"Dominican Republic\"                                  \n [13] \"Eastern Republic of Uruguay\"                         \n [14] \"Federal Democratic Republic of Ethiopia\"             \n [15] \"Federal Democratic Republic of Nepal\"                \n [16] \"Federal Republic of Germany\"                         \n [17] \"Federal Republic of Nigeria\"                         \n [18] \"Federal Republic of Somalia\"                         \n [19] \"Federative Republic of Brazil\"                       \n [20] \"French Republic\"                                     \n [21] \"Gabonese Republic\"                                   \n [22] \"Georgia\"                                             \n [23] \"Grand Duchy of Luxembourg\"                           \n [24] \"Hashemite Kingdom of Jordan\"                         \n [25] \"Hellenic Republic\"                                   \n [26] \"Hungary\"                                             \n [27] \"Independent State of Papua New Guinea\"               \n [28] \"Ireland\"                                             \n [29] \"Islamic Republic of Afghanistan\"                     \n [30] \"Islamic Republic of Mauritania\"                      \n [31] \"Islamic Republic of Pakistan\"                        \n [32] \"Jamaica\"                                             \n [33] \"Japan\"                                               \n [34] \"Kingdom of Bahrain\"                                  \n [35] \"Kingdom of Belgium\"                                  \n [36] \"Kingdom of Cambodia\"                                 \n [37] \"Kingdom of Denmark\"                                  \n [38] \"Kingdom of Eswatini\"                                 \n [39] \"Kingdom of Lesotho\"                                  \n [40] \"Kingdom of Morocco\"                                  \n [41] \"Kingdom of Norway\"                                   \n [42] \"Kingdom of Spain\"                                    \n [43] \"Kingdom of Sweden\"                                   \n [44] \"Kingdom of the Netherlands\"                          \n [45] \"Kyrgyz Republic\"                                     \n [46] \"Lao People's Democratic Republic\"                    \n [47] \"Lebanon\"                                             \n [48] \"Mongolia\"                                            \n [49] \"New Zealand\"                                         \n [50] \"North Macedonia\"                                     \n [51] \"People's Democratic Republic of Algeria\"             \n [52] \"People's Republic of China\"                          \n [53] \"Bolivia\"                                             \n [54] \"Portuguese Republic\"                                 \n [55] \"Puerto Rico\"                                         \n [56] \"Republic of Albania\"                                 \n [57] \"Republic of Angola\"                                  \n [58] \"Republic of Armenia\"                                 \n [59] \"Republic of Austria\"                                 \n [60] \"Republic of Belarus\"                                 \n [61] \"Republic of Benin\"                                   \n [62] \"Republic of Botswana\"                                \n [63] \"Republic of Bulgaria\"                                \n [64] \"Republic of Burundi\"                                 \n [65] \"Republic of Cabo Verde\"                              \n [66] \"Republic of Cameroon\"                                \n [67] \"Republic of Chad\"                                    \n [68] \"Republic of Chile\"                                   \n [69] \"Republic of Colombia\"                                \n [70] \"Republic of Cuba\"                                    \n [71] \"Republic of Cyprus\"                                  \n [72] \"C涔坱e d'Ivoire\"                                     \n [73] \"Republic of Ecuador\"                                 \n [74] \"Republic of El Salvador\"                             \n [75] \"Republic of Estonia\"                                 \n [76] \"Republic of Fiji\"                                    \n [77] \"Republic of Finland\"                                 \n [78] \"Republic of Ghana\"                                   \n [79] \"Republic of Guatemala\"                               \n [80] \"Republic of Guinea\"                                  \n [81] \"Republic of Guinea-Bissau\"                           \n [82] \"Republic of Guyana\"                                  \n [83] \"Republic of Haiti\"                                   \n [84] \"Republic of Honduras\"                                \n [85] \"Republic of Iceland\"                                 \n [86] \"Republic of India\"                                   \n [87] \"Republic of Indonesia\"                               \n [88] \"Republic of Iraq\"                                    \n [89] \"Republic of Kazakhstan\"                              \n [90] \"Republic of Kenya\"                                   \n [91] \"Republic of Latvia\"                                  \n [92] \"Republic of Liberia\"                                 \n [93] \"Republic of Lithuania\"                               \n [94] \"Republic of Madagascar\"                              \n [95] \"Republic of Malawi\"                                  \n [96] \"Republic of Maldives\"                                \n [97] \"Republic of Mali\"                                    \n [98] \"Republic of Malta\"                                   \n [99] \"Moldova\"                                             \n[100] \"Republic of Mozambique\"                              \n[101] \"Republic of Namibia\"                                 \n[102] \"Republic of Paraguay\"                                \n[103] \"Republic of Poland\"                                  \n[104] \"Republic of Senegal\"                                 \n[105] \"Republic of Serbia\"                                  \n[106] \"Republic of Sierra Leone\"                            \n[107] \"Republic of Singapore\"                               \n[108] \"Republic of Slovenia\"                                \n[109] \"Republic of South Africa\"                            \n[110] \"Republic of Suriname\"                                \n[111] \"Republic of Tajikistan\"                              \n[112] \"Republic of Trinidad and Tobago\"                     \n[113] \"Republic of Tunisia\"                                 \n[114] \"Republic of Turkey\"                                  \n[115] \"Republic of Uganda\"                                  \n[116] \"Republic of Uzbekistan\"                              \n[117] \"Republic of Yemen\"                                   \n[118] \"Republic of Zambia\"                                  \n[119] \"Republic of Zimbabwe\"                                \n[120] \"Congo\"                                               \n[121] \"Gambia\"                                              \n[122] \"Niger\"                                               \n[123] \"Philippines\"                                         \n[124] \"Romania\"                                             \n[125] \"Russian Federation\"                                  \n[126] \"Slovak Republic\"                                     \n[127] \"Viet Nam\"                                            \n[128] \"State of Israel\"                                     \n[129] \"State of Kuwait\"                                     \n[130] \"State of Qatar\"                                      \n[131] \"Sultanate of Oman\"                                   \n[132] \"Switzerland\"                                         \n[133] \"Togo\"                                                \n[134] \"Turkmenistan\"                                        \n[135] \"Ukraine\"                                             \n[136] \"United Arab Emirates\"                                \n[137] \"United Kingdom of Great Britain and Northern Ireland\"\n[138] \"United Mexican States\"                               \n[139] \"Tanzania\"                                            \n[140] \"United States of America\"                            \n```\n\n\n:::\n:::\n\n\n\n# 5. Time Series Visualization of Regional Trends Over Time\n\nTo examine how water, sanitation and hygiene indicators and health outcome indicators have changed over time across different regions, we developed a function to generate region-wise time series plots. For each selected variable, the dataset was grouped by year and region, and the annual mean was calculated. These aggregated values were then visualized using line plots, where each line represents a specific region. This method allows for a clear comparison of temporal trends between regions, highlighting disparities, improvements, or stagnation in access to services or disease prevalence. By plotting these trends over time, we can observe not only the overall trajectory of each indicator but also the consistency or volatility of regional performance relative to one another.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_multi_region_time_series <- function(data) {\n  variables <- c(\"BasicSanitation\", \"BasicWater\", \"OpenDefecation\", \n                 \"WaterStress\", \"WaterProductivity\", \n                 \"HepatitisA\", \"Diarrhea\", \"Typhoid\")\n  \n  for (selected_variable in variables) {\n    df_ts <- data %>%\n      group_by(year, Region) %>%\n      summarise(mean_value = mean(.data[[selected_variable]], na.rm = TRUE)) %>%\n      ungroup()\n    \n    p <- ggplot(df_ts, aes(x = year, y = mean_value, color = Region, group = Region)) +\n      geom_line(size = 1.2) +\n      geom_point(size = 2) +\n      labs(\n        title = paste(\"Time Series of\", selected_variable, \"Across Regions\"),\n        x = \"Year\",\n        y = selected_variable\n      ) +\n      theme_minimal() +\n      theme(\n        plot.title = element_text(size = 14, face = \"bold\"),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        legend.position = \"bottom\",\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 8)\n      ) +\n      scale_color_brewer(palette = \"Set2\")  \n    \n    print(p)\n  }\n}\n\n\ncreate_multi_region_time_series(cdata)\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-8.png){width=672}\n:::\n:::\n\n\n\n```         \n```\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# 设置国家和指标\nselected_country <- \"Republic of India\"\nselected_indicator <- \"Diarrhea\"\n\n# 准备数据\ndf_diarrhea <- cdata %>%\n  filter(Country == selected_country) %>%\n  select(year, !!sym(selected_indicator)) %>%\n  filter(!is.na(.data[[selected_indicator]]))\n\n# 画图\nggplot(df_diarrhea, aes(x = year, y = .data[[selected_indicator]])) +\n  geom_line(color = \"tomato\", size = 1.2) +\n  geom_point(color = \"tomato\", size = 2) +\n  labs(\n    title = paste(\"Trend of Diarrheal Diseases in\", selected_country),\n    x = \"Year\",\n    y = \"Diarrhea (%)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "EDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}